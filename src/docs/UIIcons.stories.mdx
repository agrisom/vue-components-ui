import { Meta } from '@storybook/blocks';

<Meta title="Docs/Icons"/>

# How to use UIIcon

UIIcon work with svg sprites. This file should be created and imported into your project. Follow this steps to create and load your icons to the project.

## About SVG sprites

SVG sprite is a unique file that groups all the svg images in your site. The sprite is loaded once in the document, instead of load each icon individually. The UIIcon component uses references to point to this sprite using `<svg>` and the tag `<use>`.

> Learn more about SVG sprites:
- [Google icons](https://fonts.google.com/icons)
- [Font Awesome](https://fontawesome.com/v5/docs/web/advanced/svg-sprites)

## Basic Use

This library provides a set of icons ready to use, and more will be added. To use them just follow this steps:

1. Import the sprite file to your body page
2. Use the component UIIcon to use the listed icons

**App.vue**

```
<template>
  <div class="svgsprites">
    <iframe :src="sprite" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
  </div>
  <UIIcon name="home" description="Go to home" size="sm" />
</template>

<script setup lang="ts">
import { UIIcon } from 'vue-components-ui';
import sprite from 'vue-components-ui/sprite.svg';
</script>

<style>
  .svgsprites {
    display: none;
  }
</style>
```

## Get more icons

Although the library already provides some icons, it may be useful to add new ones.
Adding new icons to the component UIIcon requires the creation of a new sprite.
The new icons are not recognized for the TS type so the autocomplete will not be availabe for these.

> If you don't have an existent sprite I give you instructions to build one.

### Install dependencies

This dependencies are required to create the sprite file.

`npm install --save-dev @flyke/svg-sprite-generator`

### Get new icons

Crete or copy the icons to your project `src/assets/svg`

> You can get them from this sources:

- [Google Fonts](https://fonts.google.com/icons)
- [Fontawesome](https://fontawesome.com/icons)
- [Flaticon](https://www.flaticon.com/icons)

### Create my-sprite.svg

Create a script to build your SVGs into a sprite file and run it with the command `node svg-icon-generator.js`.

**svg-sprite-generator.js**

```
const fs = require('fs');
const path = require('path');
const { exec } = require('child_process');
const filename = 'src/assets/my-sprite.svg';

exec('svg-sprite-generate -d ./src/assets/svg -o ./src/assets/my-sprite.svg', (error, stdout, stderr) => {
  if (error) {
    console.error(`error: ${error.message}`);
    return;
  }
  if (stderr) {
    console.error(`stderr: ${stderr}`);
    return;
  }

  fs.readFile(filename, 'utf8', function (err, data) {
    if (!err && data) {
      const idx = data.indexOf('\n') ?? 0;
      let linesExceptFirst = data.substring(idx + 1);
      fs.writeFileSync(filename, linesExceptFirst);

      generateIconNameTypescriptDefinitions();
    }
  });
});

function generateIconNameTypescriptDefinitions() {
  const iconsDir = path.resolve(__dirname, 'src/assets/svg');
  const definitionsFile = path.resolve(__dirname, 'src/shared/types/icon.type.ts');
  const files = fs.readdirSync(iconsDir);
  const iconNames = files.map(file => file.match(/^(.+)\.svg$/)[1]);

  const typescriptDefinitions = `
/*
 * AUTOGENERATED FILE - DO NOT EDIT
 * Reload this file running this command 'npm run svg-sprite' or 'npm run build'
 */

export const iconList = [${iconNames.map(name => `'${name}'`).join(', ')}] as const;
export type Icon = typeof iconList[number];
`;

  fs.writeFileSync(definitionsFile, typescriptDefinitions);
}
```

### Import the new sprite

The new sprite must be imported to the body like the provided with the library.

**App.vue**

```
<template>
  <div class="svgsprites">
    <iframe :src="sprite" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
    <iframe :src="mySprite" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
  </div>
  <UIIcon name="my-logo" description="Custom svg icon" size="sm" />
</template>

<script setup lang="ts">
import { UIIcon } from 'vue-components-ui';
import sprite from 'vue-components-ui/sprite.svg';
import mySprite from '@/assets/svg/my-sprite.svg';
</script>

<style>
  .svgsprites {
    display: none;
  }
</style>
```